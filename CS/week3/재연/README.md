<strong>목차</strong>

[1. OS 개요](OS-개요)

[2. 프로세스와 스레드](프로세스와-스레드)

[3. 인터럽트(Interrupt)](인터럽트(Interrupt))

[4. 시스템 콜(System Call)](시스템-콜(System-Call))

[5. PCB(Process Control Block)와 Context Switching](PCB(Process-Control-Block)와-Context-Switching)

[6. IPC(Inter Process Communication)](IPC(Inter-Process-Communication))





## OS 개요

운영체제(Operating System)은 하드웨어를 관리하고, 응용 프로그램과 하드웨어 사이의 인터페이스 역할을 하며, 시스템의 동작을 제어하는 시스템 소프트웨어이다.



<strong>운영체제의 역할</strong>

- 프로세스 관리
  - 운영체제에서 작동하는 응용 프로그램들을 관리하는 기능이다.
- 저장장치 관리
  - 1차 저장장치인 메인 메모리와 2차 저장장치인 하드디스크, NAND 등을 관리하는 기능이다.
    - 1차 저장장치
      - 프로세스에 할당하는 메모리 영역의 할당과 해제
      - 각 메모리 영역 간의 침범 방지
      - 메인 메모리의 효율적 활용을 위한 가상 메모리 기능
    - 2차 저장장치
      - 파일 형식의 데이터 저장
      - 파일 시스템 관리
- 네트워킹
  - 네트워크 프로토콜을 지원하여 네트워크를 사용할 수 있도록 한다.
- 사용자 관리
  - 여러 개의 계정을 관리할 수 있는 기능이다.
  - 사용자 별로 프라이버시와 보안을 위해 접근할 수 없도록 한다.
  - 사용자 외에도 파일이나 시스템 자원에 접근 권한을 지정하는 기능을 포함한다.
- 디바이스 드라이버
  - 시스템의 자원, 하드웨어를 관리한다.
  - 하드웨어를 사용하려면 디바이스 드라이버가 필요한데, 다양한 하드웨어의 디바이스 드라이버들을 관리하는 기능을 한다.





## 프로세스와 스레드

프로그램이란, 파일이 저장 장치에 저장되어 있지만 메모리에는 올라가 있지 않은 정적인 상태를 의미한다.

프로세스란 메모리에 올라와 실행되고 있는 프로그램을 의미한다.

즉, 운영체제로부터 시스템 자원을 할당받는 작업이다.



<strong>프로세스 특징</strong>

- 프로세스는 운영체제로부터 Code, Data, Stack, Heap의 독립된 메모리 영역을 할당 받는다.

- 프로세스는 각각 독립된 메모리 영역을 할당 받기 때문에 다른 프로세스의 자원에 접근할 수 없다.
- 기본적으로 프로세스당 최소 1개의 스레드를 가진다.
- 프로세스간 통신을 하기 위해서는 IPC를 사용해야 한다.

![process](https://user-images.githubusercontent.com/59406960/113096798-d84de080-9230-11eb-8b7b-40fb3133ceb0.png)



스레드란 프로세스 내에서 실행되는 흐름의 단위를 의미한다.



<strong>스레드의 특징</strong>

- 스레드는 프로세스 내에서 Stack 영역만을 할당 받고, Code, Data, Heap 영역은 공유한다.
- 한 스레드가 프로세스 자원을 변경하면 같은 프로세스 내의 다른 스레드도 변경 결과를 즉시 볼 수 있다.

![thread](https://user-images.githubusercontent.com/59406960/113097540-097ae080-9232-11eb-896a-899d56045373.png)



<strong>멀티 프로세스</strong>

멀티 프로세스란 하나 이상의 프로세스들을 동시에 처리하는 것을 의미한다.

- 장점
  - 메모리를 독립적으로 할당받아 사용하기 때문에 안정성이 높다.
- 단점
  - 각각 독립된 메모리 영역을 가지기 때문에, 작업량이 많을 수록 오버헤드가 발생, Context Switching으로 인한 성능 저하



<strong>멀티 스레드</strong>

하나의 응용 프로그램에서 여러 스레드를 구성해 각 스레드가 하나의 작업을 처리하는 것을 의미한다.

- 장점
  - Stack영역만 Context Switching이 일어나기 때문에 시간을 줄일 수 있다.
  - 자원을 공유하기 때문에 메모리 낭비를 줄일 수 있다.
- 단점
  - 자원을 공유하기 때문에 안정성에 문제가 있을 수 있다.
  - 공유 메모리를 가지기 때문에 하나의 스레드가 데이터 공간을 망가트리면 모든 스레드가 작동이 불가능해진다.





## 인터럽트(Interrupt)

인터럽트란 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행 중인 작업을 즉시 중단하고, 발생된 상황을 우선 처리한 후 실행 중이던 작업으로 복귀하는 것을 의미한다.



인터럽트는 CPU의 하드웨어 신호에 의해 발생하는 외부/내부 인터럽트와 명령어의 수행으로 발생하는 소프트웨어 인터럽트가 존재한다.

- 외부 인터럽트
  - 입출력 장치, 타이밍 장치, 전원 등 외부적인 요인으로 발생
    - ex) 전원 이상, 기계 착오, 외부 신호, 입출력
- 내부 인터럽트
  - Trap이라고 부르며, 잘못된 명령이나 데이터를 사용할 때 발생
    - ex) 0으로 나누기, 오버플로우, 명령어를 잘못 사용한 경우(Exception)
- 소프트웨어 인터럽트
  - 프로그램 처리 중 명령의 요청에 의해 발생한 것
    - SVC(SuperVisor Call) 인터럽트
  - 소프트웨어 사용 중에 다른 프로세스를 실행시키면 시분할 처리를 위해 자원 할당 동작을 수행





## 시스템 콜(System Call)

시스템 콜은 커널 모드의 기능을 사용자 모드에서 사용할 수 있도록 해주는 기능이다.

즉, 프로세스가 하드웨어에 직접 접근해서 필요한 기능을 사용할 수 있게 해주는 것이다.



<strong>시스템 콜의 유형</strong>

- 프로세스 제어(Process Control)
- 파일 조작(File Manipulation)
- 장치 관리(Device Management)
- 정보 유지(Information Maintenance)
- 통신(Communication)





## PCB(Process Control Block)와 Context Switching

PCB란 운영체제가 프로세스를 제어하기 위해 정보를 저장해 놓는 곳으로, 프로세스의 상태 정보를 저장한다.

프로세스 상태 관리와 Context Switching을 위해 필요하다.

프로세스의 특징과 상태를 저장하는 것을 Process Metadata라고 한다.

<strong>Process Metadata</strong>

- 프로세스 식별자(Process ID)
- 프로세스 상태(Process State)
  - 생성(create), 준비(ready), 실행(running), 대기(waiting), 완료(terminated) 상태가 있다. - 유예준비상태suspended ready, 유예대기상태suspended wait 는 스택이 아닌 disk에 저장된다.
- 프로그램 계수기(Program Counter)
  - 프로그램 계수기는 이 프로세스가 다음에 실행할 명령어의 주소를 가리킨다.
- CPU 레지스터 및 일반 레지스터
- CPU 스케줄링 정보
  - 우선 순위, 최종 실행시각, CPU 점유시간 등
- 메모리 관리 정보
  - 해당 프로세스의 주소 공간 등
- 프로세스 계정 정보
  - 페이지 테이블, 스케줄링 큐 포인터, 소유자, 부모 등
- 입출력 상태 정보
  - 프로세스에 할당된 입출력장치 목록, 열린 파일 목록 등

위와 같은 메타데이터는 프로세스가 생성되면 PCB에 저장된다.



Context Switching이란 CPU가 이전 프로세스의 상태를 PCB에 저장하고 다른 프로세스의 정보를 PCB에서 읽어와 레지스터에 적재하는 과정



<strong>Context Switching이 발생하는 상황</strong>

- 인터럽트 발생
- 실행 중인 CPU의 사용 허가시간을 모두 소모
- 입출력을 위해 대기해야 하는 경우





## IPC(Inter Process Communication)

IPC란 프로세스 간의 통신을 의미한다.

프로세스는 메모리 영역을 독립적으로 할당을 받기 때문에 프로세스 간 통신을 하기 위해서는 IPC를 사용하여 통신해야 한다.



<strong>IPC의 종류</strong>

- PIPE
  - 두 프로세스 사이에 파이프 두고 한 쪽은 쓰기만, 한 쪽은 읽기만 가능하다.
  - 단 방향 통신이기 때문에 반 이중 통신이라고도 한다.
  - 읽기와 쓰기를 모두 하기 위해서는 파이프를 두 개 사용해야 한다.
  - 통신을 할 프로세스가 명확하게 알 수 있는 경우 사용한다.
- Named PIPE
  - 기본적인 기능은 PIPE와 같다.
  - 전혀 무관한 프로세스들 사이의 통신을 할 때 사용한다.
- Message Queue
  - 메세지 큐는 메모리 공간을 받아 사용한다.
    - 이 공간을 컨테이너 또는 벨트라고 한다.
  - 메세지 큐에 쓸 데이터에 번호를 붙여 여러 개의 프로세스가 동시에 데이터를 다룰 수 있다.
- Shared Memory
  - 메모리 영역을 커널에서 할당해주고 프로세스들이 자유롭게 접근할 수 있는 방식이다.
  - 중개자가 없기 때문에 모든 IPC 통신 중에서 가장 빠르다
- Memory Map
  - 공유 메모리와 같이 메모리를 공유하는 방식이다.
  - 파일을 프로세스의 메모리에 일정 부분 맵핑 시켜 사용한다.
- Socket
  - 서버와 클라이언트 간의 데이터를 주고 받는 통신이다.
  - 원격으로 프로세스간 데이터를 공유할 때 사용한다.
  - socket을 생성하여 연결하고 데이터를 주고 받는다.





<strong>출처</strong>

- [[OS] 프로세스와 스레드의 차이](https://gmlwjd9405.github.io/2018/09/14/process-vs-thread.html)